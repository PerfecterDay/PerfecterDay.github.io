<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="学习笔记">
<meta name="keywords" content="java sql vue web python">
<meta property="og:type" content="website">
<meta property="og:title" content="Coder_Wang&#39;s blog">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Coder_Wang&#39;s blog">
<meta property="og:description" content="学习笔记">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Coder_Wang&#39;s blog">
<meta name="twitter:description" content="学习笔记">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/">





  <title>Coder_Wang's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Coder_Wang's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/13/数据结构与算法/链表/单链表/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/13/数据结构与算法/链表/单链表/" itemprop="url">单链表</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-13T21:30:20+08:00">
                2019-02-13
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/algorithm-and-dataStructure/" itemprop="url" rel="index">
                    <span itemprop="name">algorithm_and_dataStructure</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">public class LinkedList &#123;</span><br><span class="line">    Node head = null;</span><br><span class="line"></span><br><span class="line">    //头插</span><br><span class="line">    public void headAdd(Object val)&#123;</span><br><span class="line">        Node n = new Node(head,val);</span><br><span class="line">        head = n;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //尾插</span><br><span class="line">    public void tailAdd(Object val)&#123;</span><br><span class="line">        Node n = new Node(null,val);</span><br><span class="line">        Node p = head;</span><br><span class="line">        while (p.next != null)&#123;</span><br><span class="line">            p = p.next;</span><br><span class="line">        &#125;</span><br><span class="line">        p.next = n;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //链表逆序，时间复杂度O(n),空间复杂度O(1)</span><br><span class="line">    public void reverseList()&#123;</span><br><span class="line">        Node t = null, p = head;</span><br><span class="line">        while (p != null)&#123;</span><br><span class="line">            Node next = p.next;</span><br><span class="line">            p.next = t;</span><br><span class="line">            t = p;</span><br><span class="line">            p = next;</span><br><span class="line">        &#125;</span><br><span class="line">        head = t;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    class Node&#123;</span><br><span class="line">        Node next;</span><br><span class="line">        Object value;</span><br><span class="line"></span><br><span class="line">        public Node(Node next, Object value) &#123;</span><br><span class="line">            this.next = next;</span><br><span class="line">            this.value = value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        String str = &quot;&quot;;</span><br><span class="line">        Node p = head;</span><br><span class="line">        while (p != null)&#123;</span><br><span class="line">            str +=p.value;</span><br><span class="line">            p = p.next;</span><br><span class="line">        &#125;</span><br><span class="line">        return str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args)&#123;</span><br><span class="line">        LinkedList linkedList = new LinkedList();</span><br><span class="line">        for (int i = 0; i &lt; 10; i++) &#123;</span><br><span class="line">            linkedList.headAdd(i);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(linkedList);</span><br><span class="line">        linkedList.reverseList();</span><br><span class="line">        System.out.println(linkedList);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        for (int i = 0; i &lt; 10; i++) &#123;</span><br><span class="line">            linkedList.tailAdd(i);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(linkedList);</span><br><span class="line">        linkedList.reverseList();</span><br><span class="line">        System.out.println(linkedList);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/17/英语/单词/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/17/英语/单词/" itemprop="url">单词表</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-17T17:28:10+08:00">
                2020-05-17
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/english/" itemprop="url" rel="index">
                    <span itemprop="name">english</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>inevitably : 不可避免地</li>
<li>tolerance ：宽容，包容</li>
<li>resiliency ： 弹性</li>
<li>evolve ： 进化</li>
<li>saturated ： 饱和的</li>
<li>exacerbate ：加剧，恶化</li>
<li>transitive ： 传递性的</li>
<li>fallback ： 后备</li>
<li>bulkhead ：舱壁，隔板</li>
<li>swimlane ： 泳道</li>
<li>exceed ：超过</li>
<li>latent : 潜在的</li>
<li>reside : 居住</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/14/sql/初级SQL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/14/sql/初级SQL/" itemprop="url">初级 SQL</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-06-14T20:34:45+08:00">
                2018-06-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/sql/" itemprop="url" rel="index">
                    <span itemprop="name">sql</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/sql/sql语句/" itemprop="url" rel="index">
                    <span itemprop="name">sql语句</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="数据库表的新建修改与删除"><a href="#数据库表的新建修改与删除" class="headerlink" title="数据库表的新建修改与删除"></a>数据库表的新建修改与删除</h2><ol>
<li>创建新的数据库：<br><code>create databse [if not exists] db_name;</code></li>
<li>一个数据库服务器可以同时包含多个数据库，查看包含的数据库：<br><code>show databases</code></li>
<li>删除数据库：<br><code>drop database db_name</code></li>
<li>进入指定数据库：<br><code>use db_name</code></li>
<li>查看数据库下有多少个表：<br><code>show tables</code></li>
<li>查看某张表的结构：<br><code>desc table_name</code></li>
</ol>
<p>常见的数据库对象：<br><img src="/pics/db-obj.jpg" alt="常见的数据库对象"><br>上述对象都可以在 create 、 drop 和 alter 等于语句中使用，如 create tabel.. 、 create index… </p>
<p>Sql数据类型：<br>sql标准支持多种数据类型：</p>
<ul>
<li><strong>char(n)</strong>:<strong>固定</strong>长度的字符串，用户指定长度n，也可以使用全称character(n);</li>
<li><strong>varvhar(n)</strong>:<strong>可变长度</strong>的字符串用户指定<strong>最大长度n</strong>，等价于全称character varying(n);</li>
<li><strong>int</strong>:整数类型，等价于全称integer;</li>
<li><strong>smallint</strong>:小整数类型;</li>
<li><strong>numeric(p,d)</strong>:定点数，精度由用户指定。这个数有p位数字(包括一位符号位)，其中d位数字在小数点右边。所以一个numberic(3,1)可以精确表示44.5,但是不能精确表示444.5和0.32;</li>
<li><strong>real,double precision</strong>:浮点数与双精度浮点数，精度与机器有关;</li>
<li><strong>float(n)</strong>:精度至少为n位的浮点数。<br>每种类型都可能包含一个称作<strong>空值</strong>的特殊值 NULL 。</li>
</ul>
<p><strong>char(10)</strong>类型的字段存储“Aou”三个字符时，不足10位的部分会补上7个空格来填充，而<strong>varchar(10)</strong>存储相同值时只会占用三个字符的空间，因此更推荐使用<strong>varchar(n)</strong>数据类型。</p>
<p>Mysql 的数据类型：<br><img src="/pics/mysql-types.jpg" alt="Mysql 数据类型"></p>
<h3 id="创建数据库表"><a href="#创建数据库表" class="headerlink" title="创建数据库表"></a>创建数据库表</h3><ol>
<li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">creaet table [db-name].table-name(</span><br><span class="line">    # 可以有多个如下的列定义</span><br><span class="line">    column-name datatype [default expr],</span><br><span class="line">    ...,</span><br><span class="line">    ...,</span><br><span class="line">    primary key(column-name...)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
<li><p>从其他表中创建表并导入数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">creaet table [db-name].table-name as select col1,col2... from table2</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建一个与 table_name2 相同的表：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create table table_name like table_name2</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="修改表："><a href="#修改表：" class="headerlink" title="修改表："></a>修改表：</h3><ol>
<li>增加列<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">alter table table-name add (</span><br><span class="line">    # 可以有多个如下的列定义</span><br><span class="line">    column-name datatype [default expr],</span><br><span class="line">    ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>实际上，如果表中已经有了数据，除非给新增字段指定默认值，否则新增字段不可以指定非空约束，因为新增字段肯定是空的。</p>
<ol>
<li>修改列定义：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table table-name modify column-name datatype [default expr] [first|after column-name2]</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>first或 after column 代表将目标列修改到指定位置（column-name2 之前或之后）。如果数据表里已经有数据，修改列很容易失败，因为很可能修改的列定义与原有的数据记录有冲突。如果修改数据列的默认值，则只会对新增的数据有影响，已有的数据不会有任何影响。</p>
<ol>
<li>删除列：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table table-name drop column-name</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>删除列总是可以成功的，且会从每行中删除该列的数据，并释放该列所占的空间。所以删除列一般时间比较长，因为还要回收空间。</p>
<h3 id="删除表："><a href="#删除表：" class="headerlink" title="删除表："></a>删除表：</h3><pre><code>drop table table-name
</code></pre><h3 id="清空表："><a href="#清空表：" class="headerlink" title="清空表："></a>清空表：</h3><pre><code>truncate table-name
</code></pre><h2 id="SLQ-查询"><a href="#SLQ-查询" class="headerlink" title="SLQ 查询"></a>SLQ 查询</h2><p>Sql 查询的语法顺序:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT [DISTINCT]</span><br><span class="line">FROM</span><br><span class="line">WHERE</span><br><span class="line">GROUP BY</span><br><span class="line">HAVING</span><br><span class="line">UNION</span><br><span class="line">ORDER BY</span><br><span class="line">LIMIT/ROWNUM</span><br></pre></td></tr></table></figure></p>
<p>这 8 种关键字是有严格顺序的，<br>这 8 种关键字可以选择的写其中几种，但是顺序要按照上面的顺序来</p>
<p>SQL 查询的基本结构:<br>一个sql查询包括三种类型子句： <strong>select</strong> 子句、 <strong>from</strong> 子句、 <strong>where</strong> 子句：</p>
<ol>
<li><strong>select</strong> 子句用于列出查询结果中所需要的属性</li>
<li><strong>from</strong> 子句是一个查询求值中要访问的关系列表</li>
<li><strong>where</strong> 子句是一个作用在 <strong>from</strong> 子句中关系上的谓词。<br>一个典型的sql查询具有如下形式：</li>
</ol>
<p><img src="/pics/select-1.jpg" alt="sql查询的基本结构"></p>
<p>每个 <strong>A<sub>i</sub></strong> 代表一个属性，每个 <strong>r<sub>i</sub></strong> 代表一个关系，P是一个谓词，如果省略 <strong>where</strong> 子句，那么谓词P为true。</p>
<p>通常来说，一个SQL查询的含义可以理解如下：</p>
<ol>
<li>为<strong>from</strong>子句中列出的关系产生笛卡尔积</li>
<li>在步骤1的基础上应用 <strong>where</strong> 子句中指定的谓词</li>
<li>在步骤2结果中的每个元组，输出 <strong>select</strong> 子句中指定的属性(或表达式结果)。</li>
</ol>
<p><img src="/pics/dikaer.jpg" alt="笛卡尔积"></p>
<h3 id="order-by"><a href="#order-by" class="headerlink" title="order by"></a>order by</h3><p><code>select * from instructr order by salary desc, name asc</code><br>查询 instructr 中所有元组，按照工资从高到低排序，如果两个元组工资相同，则按照名字升序排序。如果想在多个列上进行排序，必须对每一列指定 DESC/ASC 关键字,没有指定默认为ASC.</p>
<h3 id="limit"><a href="#limit" class="headerlink" title="limit"></a>limit</h3><p><code>limit 5 offset 6</code> 或者写成 <code>limit 6,5</code><br>返回从第6行起（包括第6行）的5条数据。</p>
<h3 id="distinct"><a href="#distinct" class="headerlink" title="distinct"></a>distinct</h3><p>DISTINCT 关键字作用于所有的列，不仅仅是跟在其后的那一列，不能部分使用 DISTINCT。作用于多列时，必须所有列的值都相同才不会被重复检索出来。</p>
<h3 id="集合运算"><a href="#集合运算" class="headerlink" title="集合运算"></a>集合运算</h3><p>SQL 关系上的 <code>union 、 intersect 、 except</code> 运算对应于数学集合论中的并、交和差运算。三个运算都会自动去除输入中的重复。若想保留重复，分别在三个操作后加上 all 即可。<br><code>（select x from A) union [all] (select x from B)</code></p>
<h3 id="空值"><a href="#空值" class="headerlink" title="空值"></a>空值</h3><p>如果算术表达式的任一输入为 null，则该算术表达式的结果为空。</p>
<p>涉及 null 的比较运算的结果为 unknown，是 true 和 false 之外的第三个逻辑值。</p>
<ol>
<li>true and unknown = unknown；false and unknown = false；unknown and unknown = unknown</li>
<li>true or unknown = true；false or unknown = unknown；unknown or unknown = unknown</li>
<li>not unknown = unknown<br>如果 where 子句的谓词条件对一个元组计算出来的结果是 false 或 unknown，那么这个元组就不能被加入到结果集中。</li>
</ol>
<p>可以用 <code>is null</code> 或者 <code>is not null</code> 来判断是否为空。不能用 =、!= 来判断。</p>
<h3 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h3><ul>
<li>%：表示任何字符出现任意次数</li>
<li>_：匹配单个任意字符，而不是多个字符</li>
</ul>
<h3 id="聚集函数"><a href="#聚集函数" class="headerlink" title="聚集函数"></a>聚集函数</h3><p>聚集函数是以值得一个集合为输入，返回单个值得函数。SQL提供了五个固有的聚集函数：</p>
<ul>
<li>平均值： avg</li>
<li>最大值： max</li>
<li>最小值： min</li>
<li>总和：   sum</li>
<li>计数：   count</li>
</ul>
<h3 id="having子句"><a href="#having子句" class="headerlink" title="having子句"></a>having子句</h3><p>包含聚集、<strong>group by</strong>或<strong>having</strong>子句的查询的含义可通过下述操作序列来定义：</p>
<ol>
<li>与不带聚集的查询情况类似，最先根据 <strong>from</strong> 子句计算出一个关系； </li>
<li>如果出现 <strong>where</strong> 子句，<strong>where</strong> 子句中的谓词将应用到 <strong>from</strong> 子句的结果关系上； </li>
<li>如果出现了<strong>group by</strong>子句， 满足 <strong>where</strong> 谓词的元组通过<strong>group by</strong>子句形成分组。 如果没有 <strong>group by</strong> 子句，满足 <strong>where</strong> 谓词的整个元组集被当做一个分组。 </li>
<li>如果出现了 <strong>having</strong> 子句，它将应用到每个分组上；不满足 <strong>having</strong> 子句谓词的分组将被抛弃。 </li>
<li><strong>select</strong>子句 利用剩下的分组产生出查询结果中的元组，即在每个分组上应用聚集函数来得到单个结果元组。</li>
</ol>
<p>出现在 <strong>select</strong> 语句中但没有被聚集的属性，只能是那些出现在 <strong>group by</strong> 子句中那些的属性。换句话说，任何没有出现在 <strong>group by</strong> 子句中的属性，如果出现在 <strong>select</strong> 子句中，<strong>它只能出现在聚集函数内部</strong>，否则这样的查询就是错误的。</p>
<p>与 <strong>select</strong> 子句类似, 任何出现在 <strong>having</strong> 子句中，但没有被聚集的属性必须出现在 <strong>group by</strong> 子句中，否则查询就被当成错误的。</p>
<h3 id="对空值和布尔值的聚集"><a href="#对空值和布尔值的聚集" class="headerlink" title="对空值和布尔值的聚集"></a>对空值和布尔值的聚集</h3><p>除了 <strong>count(*)</strong> 外的所有聚集函数都<strong>忽略</strong>输入集合中的空值。</p>
<h2 id="SQL-删除"><a href="#SQL-删除" class="headerlink" title="SQL 删除"></a>SQL 删除</h2><p>SQL删除的基本结构：<br><code>delete from r wher p</code><br>r代表一个关系，p代表一个谓词条件。首先从关系r中找出p为真的元组，然后将他们删除。</p>
<p>delete 语句只能用于一个关系，如果想从多个关系中删除，必须每个关系上使用一条 delete 命令。</p>
<h2 id="SQL-插入数据"><a href="#SQL-插入数据" class="headerlink" title="SQL 插入数据"></a>SQL 插入数据</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">insert into r(c1,c2,c3...)</span><br><span class="line">values </span><br><span class="line">(value1,value2,value3...),</span><br><span class="line">(value4,value5,value6...),</span><br><span class="line">....</span><br></pre></td></tr></table></figure>
<p>如果关系r后边没有指出具体的某些列，则默认插入所有列，需要为每列指定值。如果只为指定列赋值了，那么未赋值的列将被赋予空值 null。</p>
<h2 id="SQL-更新"><a href="#SQL-更新" class="headerlink" title="SQL 更新"></a>SQL 更新</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">update r</span><br><span class="line">set c1=value1,c2=value2,...</span><br><span class="line">where p</span><br></pre></td></tr></table></figure>
<p>SQL首先检查关系中的所有元组，判断是否应该被更新，然后才执行更新。</p>
<h3 id="case…when-语句"><a href="#case…when-语句" class="headerlink" title="case…when 语句"></a>case…when 语句</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">case</span><br><span class="line">    when pred then result1</span><br><span class="line">    when pred2 then result2</span><br><span class="line">    ...</span><br><span class="line">    when predn then resuln</span><br><span class="line">    else result</span><br><span class="line">end as column_name</span><br></pre></td></tr></table></figure>
<p>统计指定条件下的数据(统计hit_cache=’true’的总合)：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sum(</span><br><span class="line">case </span><br><span class="line">    when hit_cache=&apos;true&apos; then 1 </span><br><span class="line">    else 0 </span><br><span class="line">    end</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/12/分布式/分布式锁/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/12/分布式/分布式锁/" itemprop="url">分布式锁的几种方案</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-06-12T14:43:21+08:00">
                2018-06-12
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/分布式/" itemprop="url" rel="index">
                    <span itemprop="name">分布式</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://www.cnblogs.com/austinspark-jessylu/p/8043726.html" target="_blank" rel="noopener">https://www.cnblogs.com/austinspark-jessylu/p/8043726.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/11/sql/分布式事务/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/11/sql/分布式事务/" itemprop="url">分布式事务</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-06-11T22:50:21+08:00">
                2018-06-11
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/sql/" itemprop="url" rel="index">
                    <span itemprop="name">sql</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>注：转载自-<a href="https://www.cnblogs.com/savorboard/p/distributed-system-transaction-consistency.html" target="_blank" rel="noopener">https://www.cnblogs.com/savorboard/p/distributed-system-transaction-consistency.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/10/sql/中级SQL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/10/sql/中级SQL/" itemprop="url">中级 SQL</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-06-10T21:15:35+08:00">
                2019-06-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/sql/" itemprop="url" rel="index">
                    <span itemprop="name">sql</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/sql/sql语句/" itemprop="url" rel="index">
                    <span itemprop="name">sql语句</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="连接表达式"><a href="#连接表达式" class="headerlink" title="连接表达式"></a>连接表达式</h2><p>连接运算把两个关系的属性连接成一个关系，并按照一定规则筛选、连接两个关系中的元组以放入新的连接后的关系结果中。<br>内连接：不保留未匹配元组的连接运算<br>外连接：保留某个关系或全部关系的全部元组的连接运算。</p>
<h3 id="自然连接"><a href="#自然连接" class="headerlink" title="自然连接"></a>自然连接</h3><p><strong>自然连接</strong> 运算作用于两个关系，并产生一个关系作为结果。不同于笛卡尔积（它将第一个关系的每个元组与第二个关系的所有元组都进行连接）；自然连接只考虑那些在两个关系模式中都出现的属性上取值相同的元组对。默认情况下，要求所有共同属性上的取值相同；可以使用 <code>using</code> 子句指定要求相同的列。两个关系没有公共属性，那么连接运算将变成两个关系的笛卡尔积运算。</p>
<p>A和B的自然连接：来自A表的元组和来自B表的元组在共同属性（p1,p2…）上取值相同的元组进行连接。</p>
<p>假设A、B含有共同属性（p1,p2,p3），自然连接可以用 <em>natural join</em> 表示：<br><code>A natural join B</code>（p1,p2,p3）上的取值都相同的元组进行连接<br><code>A join B using (p1)</code> p1 上值相同的元组进行连接。</p>
<h3 id="on-表达式"><a href="#on-表达式" class="headerlink" title="on 表达式"></a>on 表达式</h3><p>自然连接默认连接的是两个关系中相同属性上值相同的元组。不同属性不会被考虑在内。SQL的 on 表达式可以指定任意的连接条件。on 只能出现在连接表达式的末尾。</p>
<h3 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h3><ol>
<li>左外连接（left outer join | left join）：只保留出现在左外连接运算之前（左边）的关系中的元组。</li>
<li>右外连接（right outer join | right join）：只保留出现在右外连接运算之后（右边）的关系中的元组。</li>
<li>全外连接（full outer join | full join）：保留出现在两个关系中的元组。</li>
</ol>
<p>可以按照如下方式计算左外连接：首先，像计算内连接那样计算出内连接的结果；然后，对于内连接左侧关系中任意一个与右侧关系中任何元组都不匹配的元组t，向连接结果中加入一个元组r,r的构造如下：</p>
<ul>
<li>元组r从左侧关系的到的属性被赋予t中的值</li>
<li>r的其它属性被赋值为nul<br>右外连接与左外连接是对称的。来自右侧关系中的不匹配左侧关系任何元组的元组被补上空值，并加入到右外连接的结果中。</li>
</ul>
<p>全外连接是左外连接与右外连接的组合。先计算出内连接后，左侧关系中不匹配右侧关系任何元组的元组被添加上空值添加到结果中；类似的，右侧关系中不匹配左侧关系任何元组的元组也被添上空值加入到结果中。</p>
<h3 id="内连接"><a href="#内连接" class="headerlink" title="内连接"></a>内连接</h3><p>为了把常规连接和外连接区分开来，SQL中把常规连接称作内连接。可以用 inner join 替换 outer join，inner 是可选的，当 join 子句中没有使用 outer 前缀，默认的连接类型是 inner join。</p>
<p>下图给出了所有连接类型的列表。任意的连接形式可以和任意的连接条件（自然连接、using条件连接或on条件连接）进行组合。<br><img src="/pics/join.jpg" alt="连接类型和连接条件"></p>
<h2 id="完整性约束"><a href="#完整性约束" class="headerlink" title="完整性约束"></a>完整性约束</h2><p>完整性约束保证授权用户对数据库所做的修改不会破坏数据的一致性，防止的是对数据库的以外破坏。</p>
<h3 id="单个关系上的约束"><a href="#单个关系上的约束" class="headerlink" title="单个关系上的约束"></a>单个关系上的约束</h3><ol>
<li><p>primary key<br>主键约束</p>
</li>
<li><p>not null<br>指定了 not null 的列，不允许插入 null 值。任何尝试插入 null 的操作都会失败</p>
</li>
<li><p>unique<br><code>unique(A1 ,A2, A3 ....)</code><br>unique声明指出属性 A1 ,A2, A3 ….形成一个候选码；即在关系中没有两个元组能在所有列出的属性上取值相同。但是属性值可以为null。</p>
</li>
<li><p>check子句<br>当应用于关系声明时（创建表时），check(P)子句指定一个谓词P，关系中的每个元组都必须满足谓词P。</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create table T(</span><br><span class="line">    id varchar(10),</span><br><span class="line">    season varchar(8),</span><br><span class="line">    ....,</span><br><span class="line">    primary key(id),</span><br><span class="line">    check(season in(&apos;Spring&apos;,&apos;Summer&apos;,&apos;Autumn&apos;,&apos;Winter&apos;))</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="参照完整性（多个关系）"><a href="#参照完整性（多个关系）" class="headerlink" title="参照完整性（多个关系）"></a>参照完整性（多个关系）</h3><p>参照完整性用来保证一个关系中给定属性集上的取值也在另一个关系的特定属性集的取值中出现。</p>
<p>外键就是参照完整性约束。关系 r1 和 r2 的属性集分别为 R1 和 R2，主码分别为 K1 和 K2。如果要求对 r2 中任意元组 t2，均存在 r1 中的元组 t1 使得 t1.K1 = t2.\alpha ，我们称 R2 的子集 \alpha 为参照关系 r1 中 K1 的外键。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/03/分布式/一致性哈希算法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/03/分布式/一致性哈希算法/" itemprop="url">一致性哈希算法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-07-03T15:11:21+08:00">
                2018-07-03
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/分布式/" itemprop="url" rel="index">
                    <span itemprop="name">分布式</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="传统的-Hash-算法"><a href="#传统的-Hash-算法" class="headerlink" title="传统的 Hash 算法"></a>传统的 Hash 算法</h2><p>假设有 N 台机器组成的缓存集群，关键字 K 缓存的目标机器编号由 hash(K)%N 计算出来。该方法存在以下问题：</p>
<ol>
<li>假设增加了一台机器，则新的计算方式为 hash(K)%(N+1),这样会导致所有的原有的缓存失效。如果不增加 N 的值，则新增的机器无法使用。</li>
<li>假设有一台机器出现故障，则新的计算方式为 hash(K)%(N-1),这样也会导致所有的缓存失效。如果不减少 N 的值，则 hash 到故障机器上的值会一直失败，导致无法缓存。</li>
</ol>
<h2 id="一致性-Hash-算法"><a href="#一致性-Hash-算法" class="headerlink" title="一致性 Hash 算法"></a>一致性 Hash 算法</h2><p>一致性哈希算法的基本实现原理是将机器节点和 Key 值都按照一样的hash算法映射到一个 0~2^32 的圆环上。当有一个写入缓存的请求到来时，计算 Key 值 K 对应的哈希值 Hash(K)，如果该值正好对应之前某个机器节点的 Hash 值，则直接写入该机器节点，如果没有对应的机器节点，则顺时针查找下一个机器节点，进行写入，如果超过 2^32 还没找到对应节点，则从 0 开始查找(因为是环状结构)。如下图所示：</p>
<p><img src="/pics/consistance-hash.png" alt="一致性哈希算法"></p>
<p>另外具体机器映射时，还可以根据处理能力不同，将一个实体节点映射到多个虚拟节点。</p>
<p>经过一致性哈希算法散列之后，</p>
<ol>
<li>当有新的机器加入时，将只影响一台机器的存储情况，例如新加入的节点H的散列在B与C之间，则原先由C处理的一些数据可能将移至H处理，而其他所有节点的处理情况都将保持不变，因此表现出很好的单调性。</li>
<li>而如果删除一台机器，例如删除C节点，此时原来由C处理的数据将移至D节点，而其它节点的处理情况仍然不变。而由于在机器节点散列和缓冲内容散列时都采用了同一种散列算法，因此也很好得降低了分散性和负载。而通过引入虚拟节点的方式，也大大提高了平衡性。</li>
</ol>
<h3 id="一致性Hash-的缺点"><a href="#一致性Hash-的缺点" class="headerlink" title="一致性Hash 的缺点"></a>一致性Hash 的缺点</h3><p>这种方式相比节点取余最大的好处在于加入和删除节点只影响哈希环中相邻的节点，对其他节点无影响。但一致性哈希分区存在几个问题：</p>
<ol>
<li>加减节点会造成哈希环中部分数据无法命中，需要手动处理或者忽略这部分数据，因此一致性哈希常用于缓存场景。</li>
<li>当使用少量节点时，节点变化将大范围影响哈希环中数据映射，因此这种方式不适合少量数据节点的分布式方案。</li>
<li>普通的一致性哈希分区在增减节点时需要增加一倍或减去一半节点才能保证数据和负载的均衡。</li>
</ol>
<p>正因为一致性哈希分区的这些缺点，一些分布式系统采用虚拟槽对一致性哈希进行改进，比如Dynamo系统。</p>
<h2 id="虚拟槽分区"><a href="#虚拟槽分区" class="headerlink" title="虚拟槽分区"></a>虚拟槽分区</h2><p>虚拟槽分区巧妙地使用了哈希空间，使用分散度良好的哈希函数把所有数据映射到一个固定范围的整数集合中，整数定义为槽（slot）。这个范围一般远远大于节点数，比如 Redis Cluster 槽范围是0~16383。槽是集群内数据管理和迁移的基本单位。采用大范围槽的主要目的是为了方便数据拆分和集群扩展。每个节点会负责一定数量的槽。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/TCP-IP/wireshark常用命令/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/TCP-IP/wireshark常用命令/" itemprop="url">wireshark 常用命令</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-10T21:24:26+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/网络协议/" itemprop="url" rel="index">
                    <span itemprop="name">网络协议</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>过滤地址<br>ip.addr==192.168.10.10  或  ip.addr eq 192.168.10.10  #过滤地址<br>ip.src==192.168.10.10     #过滤源地址<br>ip.dst==192.168.10.10     #过滤目的地址</p>
<p>过滤协议，直接输入协议名<br>icmp<br>http</p>
<p>过滤协议和端口<br>tcp.port==80<br>tcp.srcport==80<br>tcp.dstport==80</p>
<p>过滤http协议的请求方式<br>http.request.method==”GET”<br>http.request.method==”POST”<br>http.request.uri contains admin   #url中包含admin的<br>http.request.code==404    #http请求状态码的</p>
<p>连接符<br>&amp;&amp;<br>||<br>and<br>or</p>
<p>通过连接符可以把上面的命令连接在一起，比如：<br>ip.src==192.168.10.10 and http.request.method==”POST”</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/06/web/webpack入门教程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/06/web/webpack入门教程/" itemprop="url">webpack入门教程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-06T18:00:00+08:00">
                2018-11-06
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index">
                    <span itemprop="name">web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="webpack安装"><a href="#webpack安装" class="headerlink" title="webpack安装"></a>webpack安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//全局安装</span><br><span class="line">npm install -g webpack</span><br><span class="line">//安装到你的项目目录</span><br><span class="line">npm install --save-dev webpack</span><br><span class="line">```    </span><br><span class="line">## webpack打包单文件</span><br></pre></td></tr></table></figure>
<h1 id="extry-file-出填写入口文件的路径，本文中就是上述main-js的路径，"><a href="#extry-file-出填写入口文件的路径，本文中就是上述main-js的路径，" class="headerlink" title="{extry file}出填写入口文件的路径，本文中就是上述main.js的路径，"></a>{extry file}出填写入口文件的路径，本文中就是上述main.js的路径，</h1><h1 id="destination-for-bundled-file-处填写打包文件的存放路径"><a href="#destination-for-bundled-file-处填写打包文件的存放路径" class="headerlink" title="{destination for bundled file}处填写打包文件的存放路径"></a>{destination for bundled file}处填写打包文件的存放路径</h1><h1 id="填写路径的时候不用添加"><a href="#填写路径的时候不用添加" class="headerlink" title="填写路径的时候不用添加{}"></a>填写路径的时候不用添加{}</h1><p>webpack {entry file} {destination for bundled file}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">指定入口文件后，webpack将自动识别项目所依赖的其它文件，不过需要注意的是如果你的webpack不是全局安装的，那么当你在终端中使用此命令时，需要额外指定其在node_modules中的地址，继续上面的例子，在终端中输入如下命令</span><br></pre></td></tr></table></figure></p>
<h1 id="webpack非全局安装的情况"><a href="#webpack非全局安装的情况" class="headerlink" title="webpack非全局安装的情况"></a>webpack非全局安装的情况</h1><p>node_modules/.bin/webpack app/main.js public/bundle.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## webpack配置文件执行打包任务</span><br><span class="line">Webpack拥有很多其它的比较高级的功能（比如说本文后面会介绍的loaders和plugins），这些功能其实都可以通过命令行模式实现，但是正如前面提到的，这样不太方便且容易出错的，更好的办法是定义一个配置文件，这个配置文件其实也是一个简单的JavaScript模块，我们可以把所有的与打包相关的信息放在里面。</span><br><span class="line"></span><br><span class="line">继续上面的例子来说明如何写这个配置文件，在当前练习文件夹的根目录下新建一个名为webpack.config.js的文件，我们在其中写入如下所示的简单配置代码，目前的配置主要涉及到的内容是入口文件路径和打包后文件的存放路径。</span><br></pre></td></tr></table></figure></p>
<p>module.exports = {<br>    entry:  <strong>dirname + “/app/main.js”,//已多次提及的唯一入口文件<br>    output: {<br>        path: </strong>dirname + “/public”,//打包后的文件存放的地方<br>        filename: “bundle.js”//打包后输出文件的文件名<br>    }<br>}<br>注：“__dirname”是node.js中的一个全局变量，它指向当前执行脚本所在的目录。<br>```<br>有了这个配置之后，再打包文件，只需在终端里运行webpack(非全局安装需使用node_modules/.bin/webpack)命令就可以了。</p>
<p>想要更快的执行打包，可以在 <code>package.json</code>中对<code>scripts</code>对象添加一个命令。然后通过<code>npm run {script name}</code>来运行。</p>
<p><code>package.json</code>中的<code>script</code>会安装一定顺序寻找命令对应位置，本地的<code>node_modules/.bin</code>路径就在这个寻找清单中，所以无论是全局还是局部安装的Webpack，你都不需要写前面那指明详细的路径了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/10/vue/vue-router总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/10/vue/vue-router总结/" itemprop="url">vue-router总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-10T10:22:12+08:00">
                2018-11-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vue/" itemprop="url" rel="index">
                    <span itemprop="name">vue</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>用 Vue.js + Vue Router 创建单页应用，是非常简单的。使用 Vue.js ，我们已经可以通过组合组件来组成应用程序，当你要把 Vue Router 添加进来，我们需要做的是，</p>
<ul>
<li>将组件 (components) 映射到路由 (routes)，</li>
<li>然后告诉 Vue Router 在哪里渲染它们。</li>
</ul>
<h3 id="组件路由映射"><a href="#组件路由映射" class="headerlink" title="组件路由映射"></a>组件路由映射</h3><p>通常使用一个数组来定义组件与路由之间的映射关系，将数组作为选项传递给 VueRouter 构造函数：</p>
<pre><code>const router = new VueRouter({
    routes: [
        // 动态路径参数 以冒号开头
        { path: &#39;/user/&#39;, component: User ,children:[],name:&#39;user&#39;}
    ]
})
</code></pre><p>数组中的每一项描述了一条或多条路由规则，</p>
<h4 id="动态路由匹配"><a href="#动态路由匹配" class="headerlink" title="动态路由匹配"></a>动态路由匹配</h4><p>我们经常需要把某种模式匹配到的所有路由，全都映射到同个组件。例如，我们有一个 User 组件，对于所有 ID 各不相同的用户，都要使用这个组件来渲染。那么，我们可以在 vue-router 的路由路径中使用“动态路径参数”(dynamic segment) 来达到这个效果：</p>
<pre><code>const router = new VueRouter({
    routes: [
        // 动态路径参数 以冒号开头
        { path: &#39;/user/:id&#39;, component: User }
    ]
})
</code></pre><p>一个“路径参数”使用冒号 : 标记。当匹配到一个路由时，参数值会被设置到 <code>this.$route.params</code> ，可以在每个组件内使用。</p>
<p>可以在一个路由中设置多段“路径参数”，对应的值都会设置到 $route.params 中:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">模式</th>
<th style="text-align:center">匹配路径</th>
<th style="text-align:center">$route.params</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">/user/:username</td>
<td style="text-align:center">/user/evan</td>
<td style="text-align:center">{ username: ‘evan’ }</td>
</tr>
<tr>
<td style="text-align:center">/user/:username/post/:post_id</td>
<td style="text-align:center">/user/evan/post/123</td>
<td style="text-align:center">{ username: ‘evan’, post_id: 123 }</td>
</tr>
</tbody>
</table>
</div>
<h4 id="高级匹配模式"><a href="#高级匹配模式" class="headerlink" title="高级匹配模式"></a>高级匹配模式</h4><p><code>vue-router</code> 使用 <code>path-to-regexp</code> 作为路径匹配引擎，所以支持很多高级的匹配模式，例如：可选的动态路径参数、匹配零个或多个、一个或多个，甚至是自定义正则匹配。</p>
<h3 id="匹配优先级"><a href="#匹配优先级" class="headerlink" title="匹配优先级"></a>匹配优先级</h3><p>有时候，同一个路径可以匹配多个路由，此时，匹配的优先级就按照路由的定义顺序：谁先定义的，谁的优先级就最高。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/07/vue/vue-cli-service简介/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/07/vue/vue-cli-service简介/" itemprop="url">vue-cli-service简介</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-07T13:26:00+08:00">
                2018-11-07
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index">
                    <span itemprop="name">web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>通过npm安装 ： <code>npm install @vue/cli-service -D</code>.<br><code>@vue/cli-service</code> 安装了一个名为 <code>vue-cli-service</code> 的命令。你可以在 <code>npm scripts</code> 中以 <code>vue-cli-service</code> 、或者从终端中以 <code>./node_modules/.bin/vue-cli-service</code> 访问这个命令。</p>
<h2 id="vue-cli-service-serve"><a href="#vue-cli-service-serve" class="headerlink" title="vue-cli-service serve"></a>vue-cli-service serve</h2><pre><code>用法：vue-cli-service serve [options] [entry]
选项：
--open    在服务器启动时打开浏览器
--copy    在服务器启动时将 URL 复制到剪切版
--mode    指定环境模式 (默认值：development)
--host    指定 host (默认值：0.0.0.0)
--port    指定 port (默认值：8080)
--https   使用 https (默认值：false)
</code></pre><p>vue-cli-service serve 命令会启动一个开发服务器 (基于 webpack-dev-server) 并附带开箱即用的模块热重载 (Hot-Module-Replacement)。</p>
<p>除了通过命令行参数，你也可以使用 vue.config.js 里的 devServer 字段配置开发服务器</p>
<h2 id="vue-cli-service-build"><a href="#vue-cli-service-build" class="headerlink" title="vue-cli-service build"></a>vue-cli-service build</h2><pre><code>用法：vue-cli-service build [options] [entry|pattern]

选项：
--mode        指定环境模式 (默认值：production)
--dest        指定输出目录 (默认值：dist)
--modern      面向现代浏览器不带自动回退地构建应用
--target      app | lib | wc | wc-async (默认值：app)
--name        库或 Web Components 模式下的名字 (默认值：package.json 中的 &quot;name&quot; 字段或入口文件名)
--no-clean    在构建项目之前不清除目标目录
--report      生成 report.html 以帮助分析包内容
--report-json 生成 report.json 以帮助分析包内容
--watch       监听文件变化
</code></pre><p>vue-cli-service build 会在 dist/ 目录产生一个可用于生产环境的包，带有 JS/CSS/HTML 的压缩，和为更好的缓存而做的自动的 vendor chunk splitting。它的 chunk manifest 会内联在 HTML 里。</p>
<p>这里还有一些有用的命令参数：</p>
<ul>
<li>—modern 使用现代模式构建应用，为现代浏览器交付原生支持的 ES2015 代码，并生成一个兼容老浏览器的包用来自动回退。</li>
<li>—target 允许你将项目中的任何组件以一个库或 Web Components 组件的方式进行构建。更多细节请查阅构建目标。</li>
<li>—report 和 —report-json 会根据构建统计生成报告，它会帮助你分析包中包含的模块们的大小</li>
</ul>
<h2 id="vue-cli-service-inspect"><a href="#vue-cli-service-inspect" class="headerlink" title="vue-cli-service inspect"></a>vue-cli-service inspect</h2><pre><code>用法：vue-cli-service inspect [options] [...paths]
选项：
--mode    指定环境模式 (默认值：development)
</code></pre><p>你可以使用 vue-cli-service inspect 来审查一个 Vue CLI 项目的 webpack config.</p>
<h2 id="查看所有的可用命令"><a href="#查看所有的可用命令" class="headerlink" title="查看所有的可用命令"></a>查看所有的可用命令</h2><p>有些 CLI 插件会向 vue-cli-service 注入额外的命令。例如 @vue/cli-plugin-eslint 会注入 vue-cli-service lint 命令。你可以运行以下命令查看所有注入的命令：</p>
<pre><code>npx vue-cli-service help
npx vue-cli-service help [command]
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/16/linux/vim手册/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/16/linux/vim手册/" itemprop="url">vim 手册</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-16T22:43:40+08:00">
                2019-02-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index">
                    <span itemprop="name">linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Mac 下可以使用 vimtutor 学习 vim。 直接在终端输入命令 vimtutor 即可。</p>
<ol>
<li>统计字符串出现的次数： :%s/pattern//gn</li>
<li>命令模式下，关闭行号：set nonumber ，开启行号：set number</li>
<li>删除全部内容: ggdG</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/29/spring/spring中 context-annotation-config 的作用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/09/29/spring/spring中 context-annotation-config 的作用/" itemprop="url">spring中 context:annotation-config 的作用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-09-29T15:09:45+08:00">
                2018-09-29
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/" itemprop="url" rel="index">
                    <span itemprop="name">spring</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>转自：<a href="http://blog.51cto.com/mushiqianmeng/723880" target="_blank" rel="noopener">http://blog.51cto.com/mushiqianmeng/723880</a></p>
<p>在Spring的配置文件中，你可能会见到 <code>&lt;context:annotation-config/&gt;</code> 这样一条配置，他的作用是式地向 Spring 容器注册<br><code>AutowiredAnnotationBeanPostProcessor</code> 、 <code>CommonAnnotationBeanPostProcessor</code>、<br><code>PersistenceAnnotationBeanPostProcessor</code> 以及 <code>RequiredAnnotationBeanPostProcessor</code> 这 4 个 <code>BeanPostProcessor</code> 。</p>
<p>注册这4个 <code>BeanPostProcessor</code> 的作用，就是为了你的系统能够识别相应的注解。</p>
<p>例如：</p>
<p>如果你想使用 <code>@Autowired</code> 注解，那么就必须事先在 <code>Spring</code> 容器中声明 <code>AutowiredAnnotationBeanPostProcessor</code> Bean。传统声明方式如下：</p>
<pre><code>&lt;bean class=&quot;org.springframework.beans.factory.annotation. AutowiredAnnotationBeanPostProcessor &quot;/&gt; 
</code></pre><p>如果想使用 <code>@Resource</code> 、 <code>@PostConstruct</code> 、 <code>@PreDestroy</code> 等注解就必须声明 <code>CommonAnnotationBeanPostProcessor</code> Bean.</p>
<p>如果想使用 <code>@PersistenceContext</code> 注解，就必须声明 <code>PersistenceAnnotationBeanPostProcessor</code> 的 Bean。</p>
<p>如果想使用 <code>@Required</code> 的注解，就必须声明 <code>RequiredAnnotationBeanPostProcessor</code> 的 Bean。<br>同样，传统的声明方式如下：</p>
<pre><code>&lt;bean class=&quot;org.springframework.beans.factory.annotation.RequiredAnnotationBeanPostProcessor&quot;/&gt; 
</code></pre><p>一般来说，这些注解我们还是比较常用，尤其是 <code>@Autowired</code> 的注解，在自动注入的时候更是经常使用，所以如果总是需要按照传统的方式一条一条配置显得有些繁琐和没有必要，于是spring给我们提供 <code>&lt;context:annotation-config/&gt;</code> 的简化配置方式，自动帮你完成声明。</p>
<p>不过，呵呵，我们使用注解一般都会配置扫描包路径选项</p>
<pre><code>&lt;context:component-scan base-package=”XX.XX”/&gt; 
</code></pre><p>该配置项其实也包含了自动注入上述processor的功能，因此当使用 <code>&lt;context:component-scan/&gt;</code> 后，就可以将 <code>&lt;context:annotation-config/&gt;</code> 移除了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/27/spring/spring_mvc/spring mvc中DispatcherServlet初始化分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/09/27/spring/spring_mvc/spring mvc中DispatcherServlet初始化分析/" itemprop="url">springmvc中DispatcherServlet初始化分析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-09-27T21:54:23+08:00">
                2018-09-27
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/" itemprop="url" rel="index">
                    <span itemprop="name">spring</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/MVC/" itemprop="url" rel="index">
                    <span itemprop="name">MVC</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>首先看 <code>DispatcherServlet</code> 继承关系：<br><code>DispatcherServlet</code> ——&gt; <code>FrameworkServlet</code> ——-&gt; <code>HttpServletBean</code> ——&gt; <code>HttpServlet</code></p>
<p>找到 <code>HttpServletBean</code> 的 <code>init</code> 方法：</p>
<pre><code>@Override
public final void init() throws ServletException {
    // Set bean properties from init parameters.
    PropertyValues pvs = new ServletConfigPropertyValues(getServletConfig(), this.requiredProperties);
    if (!pvs.isEmpty()) {
        BeanWrapper bw = PropertyAccessorFactory.forBeanPropertyAccess(this);
        ResourceLoader resourceLoader = new ServletContextResourceLoader(getServletContext());
        bw.registerCustomEditor(Resource.class, new ResourceEditor(resourceLoader, getEnvironment()));
        initBeanWrapper(bw);
        bw.setPropertyValues(pvs, true);
    }
    // Let subclasses do whatever initialization they like.
    initServletBean();
}
</code></pre><p>跟到 <code>FrameworkServlet</code> 的 <code>initServletBean</code> 方法：</p>
<pre><code>@Override
protected final void initServletBean() throws ServletException {
    this.webApplicationContext = initWebApplicationContext();
    initFrameworkServlet();    
}
</code></pre><p>继续跟到 <code>initWebApplicationContext</code> 方法：</p>
<pre><code>protected WebApplicationContext initWebApplicationContext() {
    WebApplicationContext rootContext =
            WebApplicationContextUtils.getWebApplicationContext(getServletContext());
    WebApplicationContext wac = null;
    if (this.webApplicationContext != null) {
        wac = this.webApplicationContext;
        if (wac instanceof ConfigurableWebApplicationContext) {
            ConfigurableWebApplicationContext cwac = (ConfigurableWebApplicationContext) wac;
            if (!cwac.isActive()) {
                    if (cwac.getParent() == null) {
                    cwac.setParent(rootContext);
                }
                configureAndRefreshWebApplicationContext(cwac);
            }
        }
    }
    if (wac == null) {
        wac = findWebApplicationContext();
    }
    if (wac == null) {
        wac = createWebApplicationContext(rootContext);
    }
    if (!this.refreshEventReceived) {
        onRefresh(wac);
    }
    return wac;
}
</code></pre><p>一路跟到 <code>FrameworkServlet</code> 的 <code>createWebApplicationContext</code> 方法：</p>
<pre><code>protected WebApplicationContext createWebApplicationContext(@Nullable ApplicationContext parent) {
    ConfigurableWebApplicationContext wac =
            (ConfigurableWebApplicationContext) BeanUtils.instantiateClass(contextClass);
    wac.setEnvironment(getEnvironment());
    //设置 parent 上下文
    wac.setParent(parent);
    String configLocation = getContextConfigLocation();
    if (configLocation != null) {
        wac.setConfigLocation(configLocation);
    }
    configureAndRefreshWebApplicationContext(wac);
    return wac;
}
</code></pre><p>跟着看 <code>configureAndRefreshWebApplicationContext</code> 方法：</p>
<pre><code>protected void configureAndRefreshWebApplicationContext(ConfigurableWebApplicationContext wac) {
    wac.setServletContext(getServletContext());
    wac.setServletConfig(getServletConfig());
    wac.setNamespace(getNamespace());
    wac.addApplicationListener(new SourceFilteringListener(wac, new ContextRefreshListener()));
    ConfigurableEnvironment env = wac.getEnvironment();
    if (env instanceof ConfigurableWebEnvironment) {
        ((ConfigurableWebEnvironment) env).initPropertySources(getServletContext(), getServletConfig());
    }
    postProcessWebApplicationContext(wac);
    applyInitializers(wac);
    wac.refresh();
}
</code></pre><p>于是可以看出， <code>DispatcherServlet</code> 初始化了 ApplicationContext。</p>
<p>再看 <code>DispatcherServlet</code> 的 <code>onRefresh</code> 方法：</p>
<pre><code>protected void onRefresh(ApplicationContext context) {
    initStrategies(context);
}

/**
 * Initialize the strategy objects that this servlet uses.
 * &lt;p&gt;May be overridden in subclasses in order to initialize further strategy objects.
 */
protected void initStrategies(ApplicationContext context) {
    initMultipartResolver(context);
    initLocaleResolver(context);
    initThemeResolver(context);
    initHandlerMappings(context);
    initHandlerAdapters(context);
    initHandlerExceptionResolvers(context);
    initRequestToViewNameTranslator(context);
    initViewResolvers(context);
    initFlashMapManager(context);
}
</code></pre><p>到此， DispatcherServlet 的初始化流程大致清晰了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/27/spring/spring_mvc/Spring mvc中ContextLoaderListener分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/09/27/spring/spring_mvc/Spring mvc中ContextLoaderListener分析/" itemprop="url">springmvc中ContextLoaderListener分析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-09-27T21:00:00+08:00">
                2018-09-27
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/" itemprop="url" rel="index">
                    <span itemprop="name">spring</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/MVC/" itemprop="url" rel="index">
                    <span itemprop="name">MVC</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>典型的Spring mvc项目的 web.xml配置：</p>
<pre><code>&lt;context-param&gt;
    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
    &lt;param-value&gt;
        classpath:spring-common-config.xml,
        classpath:spring-budget-config.xml
    &lt;/param-value&gt;
&lt;/context-param&gt;
&lt;listener&gt;  
    &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;
&lt;/listener&gt;
</code></pre><p>contextConfigLocation 参数配置了 Spring 上下文的 bean 配置，我们来看看，这个配置是如何生效的。</p>
<h1 id="ContextLoaderListener"><a href="#ContextLoaderListener" class="headerlink" title="ContextLoaderListener"></a>ContextLoaderListener</h1><p>首先，看 <code>ContextLoaderListener</code> 的定义：</p>
<pre><code>public class ContextLoaderListener extends ContextLoader implements ServletContextListener{}
</code></pre><p><code>ServletContextListener</code> 的 <code>contextInitialized</code> 方法的注释：</p>
<pre><code> Notification that the web application initialization process is starting.
 All ServletContextListeners are notified of context initialization before
 any filter or servlet in the web application is initialized.
</code></pre><p>就是说 <code>contextInitialized</code> 方法会在所有的其他 <code>filter</code> 或者 <code>servlet</code> 被初始化之前执行。</p>
<p><code>ContextLoaderListener</code> 实现了 <code>ServletContextListener</code> 接口：</p>
<pre><code>public void contextInitialized(ServletContextEvent event) {
    //调用父类 ContextLoader 的 initWebApplicationContext 方法
    initWebApplicationContext(event.getServletContext());
}
</code></pre><p><code>ContextLoader</code> 的 <code>initWebApplicationContext</code> 方法：</p>
<pre><code>public WebApplicationContext initWebApplicationContext(ServletContext servletContext) {
        if (this.context == null) {
            //生成 ConfigurableWebApplicationContext 对象
            this.context = createWebApplicationContext(servletContext);
        }
        if (this.context instanceof ConfigurableWebApplicationContext) {
            ConfigurableWebApplicationContext cwac = (ConfigurableWebApplicationContext) this.context;
            if (!cwac.isActive()) {
                if (cwac.getParent() == null) {
                    ApplicationContext parent = loadParentContext(servletContext);
                    cwac.setParent(parent);
                }
                //根据 web.xml 中的配置，配置 ConfigurableWebApplicationContext
                configureAndRefreshWebApplicationContext(cwac, servletContext);
            }
        }
        //将 ConfigurableWebApplicationContext 对象设置到 servletContext 的 ‘WebApplicationContext.root’属性上
        servletContext.setAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE, this.context);
        return this.context;
    }
}
</code></pre><p>再看 <code>configureAndRefreshWebApplicationContext</code> 方法：</p>
<pre><code>protected void configureAndRefreshWebApplicationContext(ConfigurableWebApplicationContext wac, ServletContext sc) {
    wac.setServletContext(sc);
    //获取 ServletContext 中的 contextConfigLocation 参数配置
    String configLocationParam = sc.getInitParameter(CONFIG_LOCATION_PARAM);
    if (configLocationParam != null) {
        wac.setConfigLocation(configLocationParam);
    }

    ConfigurableEnvironment env = wac.getEnvironment();
    if (env instanceof ConfigurableWebEnvironment) {
        ((ConfigurableWebEnvironment) env).initPropertySources(sc, null);
    }

    customizeContext(sc, wac);
    wac.refresh();
}
</code></pre><p>可以看出在 web.xml 中配置的 <code>contextConfigLocation</code> 参数，最终被设置到上下文中。</p>
<p>详细的可以看 <code>XmlWebApplicationContext</code> 的 <code>loadBeanDefinitions</code> 方法：</p>
<pre><code>protected void loadBeanDefinitions(XmlBeanDefinitionReader reader) throws IOException {
    String[] configLocations = getConfigLocations();
    if (configLocations != null) {
        for (String configLocation : configLocations) {
            reader.loadBeanDefinitions(configLocation);
        }
    }
}
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/10/springboot/springboot配置文件加载及常规配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/10/springboot/springboot配置文件加载及常规配置/" itemprop="url">springboot配置文件加载及常见配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-10-10T11:24:48+08:00">
                2018-10-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/springboot/" itemprop="url" rel="index">
                    <span itemprop="name">springboot</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="加载配置文件及使用"><a href="#加载配置文件及使用" class="headerlink" title="加载配置文件及使用"></a>加载配置文件及使用</h3><ol>
<li><p>配置文件加载<br> Spring/SPringboot 中可以使用 <code>@PropertySource</code>/<code>@PropertySources</code> 注解加载指定路径的配置文件：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">//动态加载文件，根据 envTarget 的值确定，默认为 persistence-mysql.properties 文件</span><br><span class="line">@PropertySource(&#123; </span><br><span class="line">&quot;classpath:persistence-$&#123;envTarget:mysql&#125;.properties&quot;</span><br><span class="line">&#125;)</span><br><span class="line">public class PropertiesWithJavaConfig &#123;</span><br><span class="line">    //...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//加载多配置文件</span><br><span class="line">@PropertySources(&#123;</span><br><span class="line">    @PropertySource(&quot;classpath:foo.properties&quot;),</span><br><span class="line">    @PropertySource(&quot;classpath:bar.properties&quot;)</span><br><span class="line">&#125;)</span><br><span class="line">public class PropertiesWithJavaConfig &#123;</span><br><span class="line">    //...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// XML 配置文件</span><br><span class="line">&lt;context:property-placeholder location=&quot;classpath:foo.properties, classpath:bar.properties&quot;/&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用配置文件  </p>
<ol>
<li><p>可以使用 <code>@Value</code> 注解使用配置文件中的配置值。  </p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//读取 jdbc.url 的值，如果没有就为defaultUrl</span><br><span class="line">@Value( &quot;$&#123;jdbc.url:defaultUrl&#125;&quot; )</span><br><span class="line">private String jdbcUrl;</span><br></pre></td></tr></table></figure>
<p> XML 配置的情况下:</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;dataSource&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot; /&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>java注解方式加载的配置文件中的值会保存到 Spring 内置的 <code>Environment</code> 对象中，所以也可以使用下述方式获取配置值  </p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Autowired</span><br><span class="line">private Environment env;</span><br><span class="line">...</span><br><span class="line">dataSource.setUrl(env.getProperty(&quot;jdbc.url&quot;));</span><br></pre></td></tr></table></figure>
<p> 注意：property-placeholder 方式加载的配置文件，不会保存到 <code>Environment</code> 对象中</p>
</li>
<li>使用分层配置的情况下，可以使用 <code>@ConfigurationProperties</code> 来加载   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">database.url=jdbc:postgresql:/localhost:5432/instance</span><br><span class="line">database.username=foo</span><br><span class="line">database.password=bar</span><br><span class="line"></span><br><span class="line">@ConfigurationProperties(prefix = &quot;database&quot;)</span><br><span class="line">public class Database &#123;</span><br><span class="line">    String url;</span><br><span class="line">    String username;</span><br><span class="line">    String password;        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>多环境配置<br> 假设我们现在有三套部署环境：</p>
<ul>
<li>Dev</li>
<li>Stage</li>
<li><p>Production<br>每套环境都有不同的配置存储在不同的配置文件中，但是配置项大都是一样的，配置值不同。在这种情况下，我们就会用到上面的动态配置文件加载：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@PropertySource(&#123; </span><br><span class="line">&quot;classpath:persistence-$&#123;envTarget:mysql&#125;.properties&quot;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>然后我们再 JVM 命令行中指定 envTarget 的值，不同环境下指定不同的值就能加载指定文件了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-DenvTarget=dev</span><br><span class="line">-DenvTarget=stage</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Springboot中的配置文件<br> 上述的配置是Spring和Springboot都支持的，在Spring Boot中，还有更多的配置方式。<br> Springboot 默认会加载 <code>src/main/resources/application.properties</code>文件，可以通过命令行参数指定默认配置文件的路径从而加载指定自定义的文件：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jvm参数： -Dspring.config.location=classpath:/configuration/stage/app.yaml</span><br><span class="line">命令行参数：--spring.config.location=classpath:/configuration/stage/app.yaml</span><br></pre></td></tr></table></figure>
<p> 多环境配置文件名需要满足 application-{profile}.properties 的格式，其中 {profile} 对应你的环境标识，比如：</p>
<pre><code>1. 开发环境：application-dev.properties  
2. 测试环境：application-test.properties  
3. 生产环境：application-prod.properties    
</code></pre><p> 至于哪个具体的配置文件会被加载，可以在在application.properties文件中或者命令行参数设置<code>spring.profiles.active</code>属性值来设置，其值对应{profile}值：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spring.profiles.active=stage</span><br><span class="line">-Dspring.profiles.active=stage</span><br></pre></td></tr></table></figure>
<p> 注意，即使配置了加载某个 profile 文件，默认的 application.properties 还是会被加载，只不过 profile 配置文件中的配置有更高的优先级。</p>
</li>
<li>一个好的倡议<br> 我们可以在 <code>src/main/resources/configuration</code> 目录下新建三个文件夹分别为 dev/stage/prod ,分别对应三种环境，三个文件中配置相同的配置文件。然后删除默认的 application.properties 配置文件，分别在三个文件夹下建立 app.properties 文件，并分别配置上 env=dev/stage/prod 配置项，然后代码中相同的配置文件只要动态加载 ${env} 即可。但是，在启动程序时要指定使用对应环境的 application.properties 配置文件（—spring.config.location=classpath:/configuration/stage/app.properties ）。</li>
</ol>
<h3 id="常用配置"><a href="#常用配置" class="headerlink" title="常用配置"></a>常用配置</h3><ol>
<li>配置端口： <code>server.port=9090</code> </li>
<li>配置启动初始化 Servlet： <code>spring.mvc.servlet.load-on-startup=1</code></li>
<li><p>日志设置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">logging.path=/user/local/log</span><br><span class="line">logging.level.com.favorites=DEBUG</span><br><span class="line">logging.level.org.springframework.web=INFO</span><br><span class="line">logging.level.org.hibernate=ERROR</span><br></pre></td></tr></table></figure>
</li>
<li><p>数据库配置：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.url=jdbc:mysql://localhost:3306/test</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=root</span><br><span class="line">spring.datasource.driver-class-name=com.mysql.jdbc.Driver</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置静态文件的URL映射：<code>spring.mvc.static-path-pattern=/resources/**</code></p>
</li>
<li>配置静态文件的目录： <code>spring.resources.static-locations=classpath:/mystatic</code></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/15/springboot/springboot作为依赖包问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/15/springboot/springboot作为依赖包问题/" itemprop="url">springboot作为依赖包问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-15T09:35:20+08:00">
                2018-05-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/springboot/" itemprop="url" rel="index">
                    <span itemprop="name">springboot</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="springboot作为依赖包问题"><a href="#springboot作为依赖包问题" class="headerlink" title="springboot作为依赖包问题"></a>springboot作为依赖包问题</h1><hr>
<ol>
<li>需求：在一个springboot项目中依赖了另一个springboot项目。</li>
<li>现象：在IDEA上，两个在一个project中时，依赖项可以正常运行。移除被依赖项后，报找不到依赖的类错误。</li>
<li>原因：springboot项目默认达成jar包，使用maven的话，默认会使用springboot的打包插件达成springboot格式的jar包，与普通的jar包格式不一样，如果作为依赖包，则依赖方会找不到依赖的类。</li>
<li><p>解决方案：移除被依赖项的pom文件中plugins节点下的spring-boot-maven-plugin。</p>
<pre><code> &lt;plugin&gt;
     &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
     &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
     &lt;configuration&gt;
         &lt;fork&gt;true&lt;/fork&gt;
     &lt;/configuration&gt;
 &lt;/plugin&gt;    
</code></pre></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/25/springboot/springboot中的ApplicationContextInitializer/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/25/springboot/springboot中的ApplicationContextInitializer/" itemprop="url">springboot 中的 ApplicationContextInitializer</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-25T21:03:23+08:00">
                2019-07-25
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/springboot/" itemprop="url" rel="index">
                    <span itemprop="name">springboot</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><code>ApplicationContextInitializer</code> 是在springboot启动过程(refresh方法前)调用,主要是在 <code>ApplicationContextInitializer</code> 中 <code>initialize</code> 方法中拉起了 <code>ConfigurationClassPostProcessor</code> 这个类(我在springboot启动流程中有描述)，通过这个 processor 实现了 beandefinition 。言归正传， <code>ApplicationContextInitializer</code> 实现主要有3中方式：</p>
<h3 id="使用spring-factories方式"><a href="#使用spring-factories方式" class="headerlink" title="使用spring.factories方式"></a>使用spring.factories方式</h3><p>首先我们自定义个类实现了 <code>ApplicationContextInitializer</code> ,然后在resource下面新建 <code>META-INF/spring.factories</code> 文件。然后在文件中加入：<br><code>org.springframework.context.ApplicationContextInitializer=com.baicy.springbootexplore.initializer.KeyInitializer</code></p>
<h3 id="application-properties添加配置方式"><a href="#application-properties添加配置方式" class="headerlink" title="application.properties添加配置方式"></a>application.properties添加配置方式</h3><p>对于这种方式是通过 <code>DelegatingApplicationContextInitializer</code> 这个初始化类中的 <code>initialize</code> 方法获取到application.properties中<code>context.initializer.classes</code>对应的类并执行对应的initialize方法。只需要将实现了ApplicationContextInitializer的类添加到application.properties即可。<br><code>context.initializer.classes=com.baicy.springbootexplore.initializer.KeyInitializer</code><br>下面是 <code>DelegatingApplicationContextInitializer</code> 加载配置文件中 initializer 的代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">private static final String PROPERTY_NAME = &quot;context.initializer.classes&quot;;</span><br><span class="line">private List&lt;Class&lt;?&gt;&gt; getInitializerClasses(ConfigurableEnvironment env) &#123;</span><br><span class="line">		String classNames = env.getProperty(PROPERTY_NAME);</span><br><span class="line">		List&lt;Class&lt;?&gt;&gt; classes = new ArrayList&lt;Class&lt;?&gt;&gt;();</span><br><span class="line">		if (StringUtils.hasLength(classNames)) &#123;</span><br><span class="line">			for (String className : StringUtils.tokenizeToStringArray(classNames, &quot;,&quot;)) &#123;</span><br><span class="line">				classes.add(getInitializerClass(className));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		return classes;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="直接通过-SpringApplication-的-add-方法"><a href="#直接通过-SpringApplication-的-add-方法" class="headerlink" title="直接通过 SpringApplication 的 add 方法"></a>直接通过 <code>SpringApplication</code> 的 <code>add</code> 方法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">    SpringApplication application = new SpringApplication(SpringbootExploreApplication.class);</span><br><span class="line">    application.addInitializers(new KeyInitializer());</span><br><span class="line">    application.run(args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>原文：<a href="https://blog.csdn.net/leileibest_437147623/article/details/81074174" target="_blank" rel="noopener">https://blog.csdn.net/leileibest_437147623/article/details/81074174</a> </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/13/spring/spring 日志配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/13/spring/spring 日志配置/" itemprop="url">spring 日志配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-13T21:40:23+08:00">
                2018-05-13
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/" itemprop="url" rel="index">
                    <span itemprop="name">spring</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="logger"><a href="#logger" class="headerlink" title="logger"></a>logger</h3><p>一个 Logger 被当作为一个实体，它们的命名是大小写敏感的，并且遵循以下规则：</p>
<blockquote>
<p>命名层次结构</p>
<p>如果一个 logger 的名字加上一个 <code>.</code> 作为另一个 logger 名字的前缀，那么该 logger 就是另一个 logger 的祖先。如果一个 logger 与另一个 logger 之间没有其它的 logger ，则该 logger 就是另一个 logger 的父级。</p>
</blockquote>
<p>Logger 能够被分成不同的等级。不同的等级（TRACE, DEBUG, INFO, WARN, ERROR）定义在 <code>ch.qos.logback.classic.Level</code> 类中。在 logback 中，类 <code>Level</code> 使用 final 修饰的，所以它不能用来被继承。一种更灵活的方式是使用 <code>Marker</code> 对象。</p>
<p>如果一个给定的 logger 没有指定一个层级，那么它就会继承离它最近的一个祖先的层级。更正式的说法是：</p>
<blockquote>
<p>对于一个给定的名为 <em>L</em> 的 logger，它的有效层级为从自身一直回溯到 root logger，直到找到第一个不为空的层级作为自己的层级。</p>
</blockquote>
<p>为了确保所有的 logger 都有一个层级，root logger 会有一个默认层级 —- DEBUG</p>
<blockquote>
<p><strong>基本选择规则</strong></p>
<p>日志的打印级别为 <em>p</em>，Logger 实例的级别为 <em>q</em>，如果 <em>p</em> &gt;= <em>q</em>，则该条日志可以打印出来。</p>
</blockquote>
<p>这条规则是 logbakc 的核心。各级别的排序为：<strong>TRACE</strong> &lt; <strong>DEBUG</strong> &lt; <strong>INFO</strong> &lt; <strong>WARN</strong> &lt; <strong>ERROR</strong>。</p>
<h3 id="Appender"><a href="#Appender" class="headerlink" title="Appender"></a>Appender</h3><p>对于给定的 logger，每一个允许输出的日志都会被转发到该 logger 的所有 appender 中去。换句话说，appender 从 logger 的层级结构中去继承叠加性。例如：如果 root logger 添加了一个 console appender，所有允许输出的日志至少会在控制台打印出来。如果再给一个叫做 <strong><em>L</em></strong> 的 logger 添加了一个 file appender，那么 <strong><em>L</em></strong> 以及 <strong><em>L</em></strong> 的子级 logger 都可以在文件和控制台打印日志。可以通过设置 additivity = false 来改写默认的设置，这样 appender 将不再具有叠加性。</p>
<p>appender 的叠加性规则如下：</p>
<blockquote>
<p>appender 的叠加性</p>
<p>logger <em>L</em> 的日志输出语句会遍历 <em>L</em> 和它的父级中所有的 appender。这就是所谓的 appender 叠加性（appender additivity）</p>
<p>如果 <em>L</em> 的某个上级 logger 为 <em>P</em>，且 <em>P</em> 设置了 additivity = false，那么 <em>L</em> 的日志会在层级在 <em>L</em> 到 <em>P</em> 之间的所有 logger 的 appender，包括 <em>P</em> 本身的 appender 中输出，但是不会在 <em>P</em> 的上级 appender 中输出。</p>
<p>logger 默认设置 additivity = true。</p>
</blockquote>
<h3 id="Layout"><a href="#Layout" class="headerlink" title="Layout"></a>Layout</h3><p>通常，用户既想自定义日志的输出地，也想自定义日志的输出格式。通过给 appender 添加一个 <em>layout</em> 可以做到。layout 的作用是将日志格式化，而 appender 的作用是将格式化后的日志输出到指定的目的地。<strong>PatternLayout</strong> 能够根据用户指定的格式来格式化日志，类似于 C 语言的 printf 函数。</p>
<h3 id="底层实现初探"><a href="#底层实现初探" class="headerlink" title="底层实现初探"></a>底层实现初探</h3><p>在介绍了基本的 logback 组件之后，我们准备介绍一下，当用户调用日志的打印方法时，logback 所执行的步骤。现在我们来分析一下当用户通过一个名为 <em>com.wombat</em> 的 logger 调用了 <strong>info()</strong> 方法时，logback 执行了哪些步骤。</p>
<ol>
<li><p>第一步：获取过滤器链</p>
<p>如果存在，则 <strong>TurboFilter</strong> 过滤器会被调用，Turbo 过滤器会设置一个上下文的阀值，或者根据每一条相关的日志请求信息，例如：<strong>Marker</strong>, <strong>Level</strong>， <strong>Logger</strong>， 消息，<strong>Throwable </strong> 来过滤某些事件。如果过滤器链的响应是 <em>FilterReply.DENY</em>，那么这条日志请求将会被丢弃。如果是 <em>FilterReply.NEUTRAL</em>，则会继续执行下一步，例如：第二步。如果响应是 <em>FilterRerply.ACCEPT</em>，则会直接跳到第三步。</p>
</li>
<li><p>第二步：应用<a href="https://github.com/YLongo/logback-chinese-manual/blob/master/02第二章：架构.md#方法打印以及基本选择规则" target="_blank" rel="noopener">基本选择规则</a></p>
<p>在这步，logback 会比较有效级别与日志请求的级别，如果日志请求被禁止，那么 logback 将会丢弃调这条日志请求，并不会再做进一步的处理，否则的话，则进行下一步的处理。</p>
</li>
<li><p>第三步：创建一个 LoggingEvent 对象 </p>
<p>如果日志请求通过了之前的过滤器，logback 将会创建一个 ch.qos.logback.classic.LoggingEvent 对象，这个对象包含了日志请求所有相关的参数，请求的 logger，日志请求的级别，日志信息，与日志一同传递的异常信息，当前时间，当前线程，以及当前类的各种信息和 MDC。MDC 将会在后续章节进行讨论。</p>
</li>
<li><p>第四步：调用 appender</p>
<p>在创建了 LoggingEvent 对象之后，logback 会调用所有可用 appender 的 doAppend() 方法。这些 appender 继承自 logger 上下文。</p>
<p>所有的 appender 都继承了 AppenderBase 这个抽象类，并实现了 doAppend() 这个方法，该方法是线程安全的。AppenderBase 的 doAppend() 也会调用附加到 appender 上的自定义过滤器。自定义过滤器能动态的动态的添加到 appender 上，在过滤器章节会详细讨论。</p>
</li>
<li><p>第五步：格式化输出</p>
<p>被调用的 Appender 负责格式化 Logging Event。但是，有些 Appender 将格式化 Logging Event 的任务委托给一个 Layout。Layout 将 LoggingEvent 实例格式化为一个字符串并返回。但需要注意的是，某些 Appender（例如 SocketAppender） 并不会把 Logging Event 转化为一个字符串，而是进行序列化。因此，它们没有并且也不需要 Layout。</p>
</li>
<li><p>第六步：发送 LoggingEvent</p>
<p>当日志事件被完全格式化之后将会通过每个 appender 发送到具体的目的地。</p>
</li>
</ol>
<h3 id="Logback-配置"><a href="#Logback-配置" class="headerlink" title="Logback 配置"></a>Logback 配置</h3><p>以下是 logback 的初始化步骤：</p>
<ol>
<li>logback 会在类路径下寻找名为 logback-test.xml 的文件。</li>
<li>如果没有找到，logback 会继续寻找名为 logback.groovy 的文件。</li>
<li>如果没有找到，logback 会继续寻找名为 logback.xml 的文件。</li>
<li>如果没有找到，将会通过 JDK 提供的 <a href="https://docs.oracle.com/javase/6/docs/api/java/util/ServiceLoader.html" target="_blank" rel="noopener">ServiceLoader</a> 工具在类路径下寻找文件 <em>META-INFO/services/ch.qos.logback.classic.spi.Configurator</em>，该文件的内容为实现了 <a href="https://logback.qos.ch/xref/ch/qos/logback/classic/spi/Configurator.html" target="_blank" rel="noopener"><code>Configurator</code></a> 接口的实现类的全限定类名。</li>
<li>如果以上都没有成功，logback 会通过 <a href="https://logback.qos.ch/xref/ch/qos/logback/classic/BasicConfigurator.html" target="_blank" rel="noopener">BasicConfigurator</a> 为自己进行配置，并且日志将会全部在控制台打印出</li>
</ol>
<p>通过系统属性 <code>logback.configurationFile</code> 可以指定默认的配置文件的路径。它的值可以是 URL，类路径下的文件或者是应用外部的文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -Dlogback.configurationFile=/path/to/config.xml chapters.configuration.MyApp1</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：文件类型只能是 “.xml” 或者 “.groovy”，其它的拓展文件将会被忽略。</p>
</blockquote>
<p>因为 <code>logback.configureFile</code> 是一个系统属性，所以也可以在应用内进行设置。但是必须在 logger 实例创建前进行设置。</p>
<p>为了让 logback 能够在配置文件改变的时候自动去扫描，需要在 <code>&lt;configuration&gt;</code> 标签上添加 <code>scan=true</code> 属性。默认情况下，一分钟扫描一次配置文件，看是否有更改。通过 <code>&lt;configuration&gt;</code> 标签上的 <code>scanPeriod</code> 属性可以指定扫描周期。扫描周期的时间单位可以是毫秒、秒、分钟或者小时。</p>
<p>logback 的配置文件非常的灵活，不需要指定 DTD 或者 xml 文件需要的语法。但是，最基本的结构为 <code>&lt;configuration&gt;</code> 元素，包含 0 或多个 <code>&lt;appender&gt;</code> 元素，其后跟 0 或多个 <code>&lt;logger&gt;</code> 元素，其后再跟最多只能存在一个的 <code>&lt;root&gt;</code> 元素。基本结构图如下：</p>
<p><img src="/pics/logback_configuration_file.png" alt="logback配置文件基本结构"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration debug=&quot;true&quot;&gt;</span><br><span class="line">    &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;</span><br><span class="line">        &lt;encoder&gt;</span><br><span class="line">            &lt;pattern&gt;%d&#123;HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;36&#125; - %msg%n&lt;/pattern&gt;</span><br><span class="line">        &lt;/encoder&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;logger name=&quot;org.example&quot; level=&quot;INFO&quot; &gt;</span><br><span class="line">        &lt;appender-ref ref=&quot;STDOUT&quot;/&gt;</span><br><span class="line">    &lt;/logger&gt;</span><br><span class="line"></span><br><span class="line">    &lt;root level=&quot;all&quot;&gt;</span><br><span class="line">        &lt;appender-ref ref=&quot;STDOUT&quot; /&gt;</span><br><span class="line">    &lt;/root&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<p>配置 logger</p>
<p>通过 <code>&lt;logger&gt;</code> 标签来过 logger 进行配置，一个 <code>&lt;logger&gt;</code> 标签必须包含一个 <em>name</em> 属性，一个可选的 <em>level</em> 属性，一个可选 <em>additivity</em> 属性。<code>additivity</code> 的值为 <em>true</em> 或 <em>false</em>。<code>level</code> 的值为 TRACE，DEBUG，INFO，WARN，ERROR，ALL，OFF，INHERITED，NULL。当 <code>level</code> 的值为 INHERITED 或 NULL 时，将会强制 logger 继承上一层的级别。</p>
<p><code>&lt;logger&gt;</code> 元素至少包含 0 或多个 <code>&lt;appender-ref&gt;</code> 元素。每一个 appender 通过这种方式被添加到 logger 上。</p>
<p>root logger 通过 <code>&lt;root&gt;</code> 元素来进行配置。它只支持一个属性——<code>level</code>。它不允许设置其它任何的属性，因为 additivity 并不适用 root logger。而且，root logger 的名字已经被命名为 “ROOT”，也就是说也不支持 name 属性。level 属性的值可以为：TRACE、DEBUG、INFO、WARN、ERROR、ALL、OFF，但是不能设置为 INHERITED 或 NULL。</p>
<p>配置 appender</p>
<p>appender 通过 <code>&lt;appender&gt;</code> 元素进行配置，需要两个强制的属性 <em>name</em> 与 <em>class</em>。<em>name</em> 属性用来指定 appender 的名字，<em>class</em> 属性需要指定类的全限定名用于实例化。<code>&lt;appender&gt;</code> 元素可以包含 0 或一个 <code>&lt;layout&gt;</code> 元素，0 或多个 <code>&lt;encoder&gt;</code> 元素，0 或多个 <code>&lt;filter&gt;</code> 元素。除了这些公共的元素之外，<code>&lt;appender&gt;</code> 元素可以包含任意与 appender 类的 JavaBean 属性相一致的元素，下图展示了一些常见的结构：</p>
<p><img src="/pics/appenderSyntax.png" alt></p>
<p><code>&lt;layout&gt;</code> 元素强制一个 class 属性去指定一个类的全限定名，用于实例化。与 <code>&lt;appender&gt;</code> 元素一样，<code>&lt;layout&gt;</code> 元素也可以包含与 layout 实例相关的属性。如果 layout 的 class 是 <code>PatternLayout</code>，那么 class 属性可以被隐藏掉，因为这个很常见。.</p>
<p><code>&lt;encoder</code> 元素强制一个 class 属性去指定一个类的全限定名，用于实例化。如果 encoder 的 class 是 <code>PatternLayoutEncoder</code>，那么基于<a href>默认类映射</a>，class 属性可以被隐藏。</p>
<p>ch.qos.logback.core.ConsoleAppender: 就跟名字显示的一样，是将日志事件附加到控制台，跟进一步说就是通过 <em>System.out</em> 或者 <em>System.err</em> 来进行输出。默认通过前者</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/13/spring/spring 事件机制/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Coder_Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coder_Wang's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/13/spring/spring 事件机制/" itemprop="url">spring 事件机制</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-13T21:40:23+08:00">
                2018-05-13
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/" itemprop="url" rel="index">
                    <span itemprop="name">spring</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Spring 的 ApplicationContext 能够发布事件并且允许注册相应的事件监听器，因此，它拥有一套完善的事件发布和监听机制。在 Java 中， <code>java.util.EventObject</code> 类和 <code>java.util.EventListener</code> 接口描述了事件和监听器。在事件体系中，除了事件和监听器外，还有另外三个重要概念。</p>
<ul>
<li>事件源：事件的生产者，任何一个 <code>EventObject</code> 都必须有一个事件源。</li>
<li>事件监听器注册表：组件或框架的事件监听器不可漂浮在空中，而必须有所依存。也就是说组件或框架必须提供一个地方保存事件监听器，这便是事件监听器注册表。当组件或框架中的事件源产生事件时，就会通知位于事件监听器注册表中的监听器。</li>
<li>事件广播器：它是事件和事件监听器沟通的桥梁，负责把事件通知给事件监听器。</li>
</ul>
<p>事件源、事件监听器注册表和事件广播器这3个角色有时可以由同一个对象承担，其实就是观察者模式中的 <code>Observable</code> ，监听器就类似于 <code>Observer</code> 。事件体系其实是观察者模式的一种具体实现方式。</p>
<h3 id="spring-事件类"><a href="#spring-事件类" class="headerlink" title="spring 事件类"></a>spring 事件类</h3><p><img src="/pics/spring-event.png" alt="Spring 事件类"><br>可以根据需要扩展 <code>ApplicationEvent</code> 定义自己的事件。</p>
<h3 id="spring-事件监听器接口"><a href="#spring-事件监听器接口" class="headerlink" title="spring 事件监听器接口"></a>spring 事件监听器接口</h3><p><img src="/pics/spring-listener.png" alt="Spring 事件监听器"></p>
<h3 id="spring-事件广播器"><a href="#spring-事件广播器" class="headerlink" title="spring 事件广播器"></a>spring 事件广播器</h3><p><img src="/pics/spring-multicaster.png" alt="Spring 事件广播器"></p>
<h3 id="Spring事件体系的具体实现"><a href="#Spring事件体系的具体实现" class="headerlink" title="Spring事件体系的具体实现"></a>Spring事件体系的具体实现</h3><p>Spring 在 <code>ApplicationContext</code> 接口的抽象实现类 <code>AbstratApplicationContext</code>中完成事件体系的搭建。<code>AbstratApplicationContext</code>中拥有一个 <code>ApplicationEventMulticaster</code> 的成员，该成员提供了容器监听器的注册表。<code>AbstratApplicationContext</code>在 <code>refresh()</code> 这个容器启动方法中通过以下3个步骤搭建了事件的基础设施：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">..</span><br><span class="line">initApplicationEventMulticaster();</span><br><span class="line">...</span><br><span class="line">registerListeners();</span><br><span class="line">...</span><br><span class="line">finishRefresh();</span><br></pre></td></tr></table></figure></p>
<p>首先初始化事件广播器，用户可以在Spring配置中定义一个事件广播器，只要实现 <code>ApplicationEventMulticater</code> 即可， spring 会通过反射机制将其注册成容器的事件广播器，如果没有找到配置的外部事件广播器， Spring 自动使用 <code>SimpleApplicationEventMulticaster</code> 作为事件广播器。</p>
<p>然后， Spring 根据反射机制，从注册的 bean 中，找出所有实现了 <code>ApplicationListener</code> 的 bean ，并将它们注册为容器的事件监听器，实际操作就是将其添加到事件广播器所提供的事件监听器注册表中。</p>
<p>最后，调用容器的事件发布接口 <strong><code>publishEvent()</code></strong> 向容器中所有的监听器发布事件。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Coder_Wang</p>
              <p class="site-description motion-element" itemprop="description">学习笔记</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">170</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">41</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">50</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Coder_Wang</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
